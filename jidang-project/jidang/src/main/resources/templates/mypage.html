<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- layout.html 상속 -->
<th:block
        th:replace="index :: layout(~{::content}, ~{::scripts}, ~{::css})">

  <!-- 추가 CSS 영역 -->
  <th:block th:fragment="css">
    <link rel="stylesheet" th:href="@{/css/mypage.css}">
  </th:block>

  <!-- 본문 컨텐츠 영역 -->
  <!-- 내부 컨텐츠 개발중으로 임시임, 동적으로 수정 예정 -->
  <div th:fragment="content" class="profile-container">

    <section class="profile-header">
      <h1>프로필</h1>
      <form th:action="@{/user/logout}" method="post" style="display: inline;">
        <button type="submit" class="logout-btn">로그아웃</button>
      </form>
    </section>

    <!-- 프로필 카드 -->
    <div class="profile-card">
      <div class="avatar-box">
        <span class="avatar-text" th:text="${user.username.substring(0,1)}">G</span>
      </div>

      <div class="profile-info">
        <h2 th:text="${user.username}">GameMaster</h2>
        <p th:text="${user.email}">gamer@example.com</p>
        <p class="join-date">가입일: <span th:text="${user.joinDate}">2024-01-15</span></p>
      </div>

      <button class="settings-btn">설정</button>
    </div>

    <!-- 칭호 영역 -->
    <section id="title-section" class="profile-section">
      <h3>나의 칭호</h3>

      <!-- 대표 칭호가 있을 때 -->
      <div class="current-badge" th:if="${user.selectedTitle != null}">
        <p class="badge-label">현재 대표 칭호</p>
        <p class="badge-name" th:text="${user.selectedTitle}">
          공략마스터
        </p>
      </div>

      <!-- 대표 칭호 없음 (선택 안 함) -->
      <p class="no-badge" th:if="${user.selectedTitle == null}">
        현재 사용 중인 칭호가 없습니다. (선택 안 함)
      </p>

      <!-- 내가 가진 칭호 목록 -->
      <div class="owned-titles" th:if="${user.titles != null and !user.titles.isEmpty()}">
        <p class="subtitle">보유 칭호</p>
        <ul>
          <li th:each="t : ${user.titles}" th:text="${t}">
            공략마스터
          </li>
        </ul>
      </div>

      <!-- 칭호 전체보기 페이지 이동 -->
      <div class="badge-actions" >
        <a class="badge-all-btn" th:href="@{/title}">
          🎖 칭호 전체보기
        </a>
      </div>
    </section>

    <!-- 내 활동 / 게시글 카드 -->
    <div class="stats-grid">
      <!-- 상단 요약 숫자 -->
      <div class="stats-summary">
        <div class="stats-number" th:text="${postCount}">0</div>
        <p>게시글</p>
      </div>

      <!-- 우측: 최근 게시글 / 없을 때 문구 -->
      <div class="stats-activity">
        <p class="stats-activity-title">최근 게시글</p>

        <!-- 게시글이 없을 때 -->
        <p class="stats-empty" th:if="${postCount == 0}">
          작성된 게시글이 없습니다.
        </p>

        <!-- 게시글이 있을 때 -->
        <ul class="stats-post-list" th:if="${postCount > 0}">
          <li th:each="post : ${userPosts}" class="stats-post-item">
            <a th:href="@{|/post/detail/${post.id}|}"
               th:text="${post.subject}"
               class="stats-post-link">
              게시글 제목
            </a>
            <span class="stats-post-date"
                  th:text="${#temporals.format(post.createDate, 'yyyy.MM.dd HH:mm')}">
          2025.12.05 21:00
        </span>
          </li>
        </ul>
      </div>
    </div>

  </div>
    <!-- 스크립트 영역 -->

  <th:block th:fragment="scripts">
    <script th:src="@{/js/mypage.js}"></script>
  </th:block>

</th:block>

</html>
